---
title: "Guinea Pig Tooth Growth Experiment"
author: "Juan Bosco Mendoza Vega"
date: "September 18 2016"
output: 
  pdf_document: 
    fig_height: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(comment = "")
knitr::opts_chunk$set(strip.white = T)
```

```{r, message = F}
library(dplyr)
library(car)
```

## Overview

The effect of Supplement type and Dose of supplement in the tooth growth of guinea pigs will be tested A brief summary of the data will be presented and means of the tooth growth of guinea pigs with different Supplement type and different Dose of supplement will be compared using confidence intervals and significance levels produced by t tests.

## Exploratory statistics

There are three variables and 60 observations. According to the summary and documentation called by `?ToothGrowth`, the variables are *Tooth length* (len, numeric); *Supplement type* (supp, factor with two levels. OJ: Orange Juice, VC: Ascorbic acid); and *Dose* in miligrams per day (dose, numeric) (Appendix X).

At a aglance there seems to be differences in *Tooth growth* by *Supplement*, and *Tooth growth* seems to increase as *Dose* increases (Appendix X).

## Assumptions

After conducting a *Shapiro-Wilks test* (Appendix X) and visually exploring *Tooth length* (Appendix X), this variable seems to be **normally distributed**.

After a conducting a *Levene's test* for homogeneity of variance (Appendix X), there's evidence that the groups to compare **don't have equal variance**.

There's no evidence that the observations are paired, so it's assumed they are *independent  groups*.

## Choice of test

Consideting our assumptions, a *t test* for non paired groups and inequal variance will be conducted.

## Comparison by Supplement type

**Orange juice vs Ascorbic acid**
```{r t test supp}
t.test(
    formula = len ~ supp,
    data = ToothGrowth,
    var.equal = F, 
    paired = F, 
    alternative = "two.sided"
)
```
The 95% confidence interval contains 0 and the significance level is not less or equal to 0.05. There are no differences in the Tooth Growth mean by *Supplement*.

## Comparison by Dose

**0.5 miligrams per day vs 1 miligram per day**
```{r .5 v 1}
dose_0.5 <- ToothGrowth %>% filter(dose == 0.5) %>% select(len)
dose_1   <- ToothGrowth %>% filter(dose == 1)   %>% select(len)
t.test(
    x = dose_0.5,
    y = dose_1,
    var.equal = F, 
    paired = F, 
    alternative = "less"
)
```
The 95% confidence interval is entirely below 0 and the significance level is less than 0.05. A dose of 0.5 miligrams has a lower Tooth growth mean than a dose of 1 miligram.

**0.5 miligram per day vs 2 miligram per day**
```{r .5 v 2}
dose_0.5 <- ToothGrowth %>% filter(dose == 0.5) %>% select(len)
dose_2   <- ToothGrowth %>% filter(dose == 2)   %>% select(len)

t.test(
    x = dose_0.5,
    y = dose_2,
    var.equal = F, 
    paired = F, 
    alternative = "less"
)
```
The 95% confidence interval is entirely below 0 and the significance level is less than 0.05. A dose of 0.5 miligrams has a lower Tooth growth mean than a dose of 2 miligrams.


**1 miligram per day vs 2 miligram per day**
```{r 1 v 2}
dose_1 <- ToothGrowth %>% filter(dose == 1) %>% select(len)
dose_2 <- ToothGrowth %>% filter(dose == 2) %>% select(len)
t.test(
    x = dose_1,
    y = dose_2,
    var.equal = F, 
    paired = F, 
    alternative = "less"
)
```
The 95% confidence interval is entirely below 0 and the significance level is less than 0.05. A dose of 1 miligram has a lower Tooth growth mean than a dose of 2 miligrams.

## Conclusion

There's a diference in tooth growth by 

There's no difference by supp.

There's a difference by dose. Lower doses correspond to lower growth.

No difference by supp at a dose equal to 2.

# Appendix

## Structure of the **ToothGrowth** data set.

```{r}
str(ToothGrowth)
summary(ToothGrowth)
```

## A. Visualization of the groups

```{r boxplots, fig.align='left'}
par(mfrow = c(1, 2))
boxplot(
    formula = len ~ supp, 
    data = ToothGrowth, 
    col = c("#FF6666", "#66BBFF"),
    xlab = "Supplement type",
    ylab = "Tooth length"
)

boxplot(
    formula = len ~ dose, 
    data = ToothGrowth, 
    col = c("#FFFF66"),
    xlab = "Dose in miligrams per day",
    ylab = "Tooth length"
)
```

## C. Test of normality of Tooth length
The ¨*Shapiro-Wilk Normality Test* is used, The null hypothesis for this test is that the given data is normally distributed. Results indicate we can't reject this hypotesis, so **we assume the distribution is normal**.
```{r normality, echo = T}
shapiro.test(ToothGrowth$len)
```

A histogram with an overlaid density curve of this variable and a Normal Q-Q plot are generated to support the assumtion its distribution is normal.
```{r histogram qqplot, echo = T}
par(mfrow = c(1, 2))
hist(ToothGrowth$len, probability = T, ylim = c(0, 0.05), 
    main = "Histogram and Density\n of Tooth length",
    xlab = "Tooth length",
    col = "#FFFF66"
    )
lines(density(ToothGrowth$len))

qqnorm(y = ToothGrowth$len, 
    main = "Normal Q-Q Plot\n for Tooth length",
    pch = 21, bg = c("#FFFF66"))
qqline(y = ToothGrowth$len)
```

## D. Test if variance is equal across groups
The *Levene's test of homogenity of variance is used*. Groups are: *Supplement type*; *Dose in miligrams per day*; and *Supplement type* and *Dose in miligrams per day*. Results indicate groups **don't have equal variance**.

```{r levene by supp, echo = T}
library(car)
leveneTest(len ~ supp, data = ToothGrowth)
leveneTest(len ~ as.factor(dose), data = ToothGrowth)
leveneTest(len ~ supp * as.factor(dose), data = ToothGrowth)
```
