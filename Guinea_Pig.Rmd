---
title: "Guinea Pig Tooth Growth Experiment"
author: "Juan Bosco Mendoza Vega"
date: "September 18 2016"
output: 
  pdf_document: 
    fig_height: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(comment = "")
knitr::opts_chunk$set(strip.white = T)
```

```{r, message = F}
library(dplyr)
library(car)
```

# Summary

We'll conduct a mean comparison of the effect of dose and supply method on theeth growth of guinea pigs. Means will be compared using t test 95% confidence interval and a significance level of 0.05.

# Exploratory statistics

Structure of the **ToothGrowth** data set.

```{r}
str(ToothGrowth)
```

There are three variables and 60 observations. According to the documentarion called by `?ToothGrowth`, our variables are **len** (Tooth length, numeric); **supp** (Supplement type, factor with two levels. OJ: Orange Juice, VC: Ascorbic acid); and **dose** (Dose in miligrams per day, numeric). 

There appear to be differences in Tooth growth by Supplement and Dose (Appendix A), but we need to test if it is statistically significant.

## Comparison of means

### By Supplement type

Orange juice vs Ascorbic acid
```{r t test supp}
t.test(
    formula = len ~ supp,
    data = ToothGrowth,
    var.equal = F, 
    paired = F, 
    alternative = "two.sided"
)
```

### By Dose in miligrams per day

0.5 miligram per day vs 1 miligram per day
```{r .5 v 1}
dose_0.5 <- ToothGrowth %>% filter(dose == 0.5) %>% select(len)
dose_1   <- ToothGrowth %>% filter(dose == 1)   %>% select(len)
t.test(
    x = dose_0.5,
    y = dose_1,
    var.equal = F, 
    paired = F, 
    alternative = "less"
)
```

0.5 miligram per day vs 2 miligram per day
```{r .5 v 2}
dose_0.5 <- ToothGrowth %>% filter(dose == 0.5) %>% select(len)
dose_2   <- ToothGrowth %>% filter(dose == 2)   %>% select(len)

t.test(
    x = dose_0.5,
    y = dose_2,
    var.equal = T, 
    paired = F, 
    alternative = "less"
)
```

1 miligram per day vs 2 miligram per day
```{r 1 v 2}
dose_1 <- ToothGrowth %>% filter(dose == 1) %>% select(len)
dose_2 <- ToothGrowth %>% filter(dose == 2) %>% select(len)
by_dose_3 <- t.test(
    x = dose_1,
    y = dose_2,
    var.equal = F, 
    paired = F, 
    alternative = "less"
)

by_dose_3
```

## Conclusion

There's a diference in tooth growth by 

There's no difference by supp.

There's a difference by dose. Lower doses correspond to lower growth.

No difference by supp at a dose equal to 2.

# Appendix

## A. Visualization of the groups

```{r boxplots, fig.align='left'}
par(mfrow = c(1, 2))
boxplot(
    formula = len ~ supp, 
    data = ToothGrowth, 
    col = c("#FF6666", "#66BBFF"),
    xlab = "Supplement type",
    ylab = "Tooth length"
)

boxplot(
    formula = len ~ dose, 
    data = ToothGrowth, 
    col = c("#FFFF66"),
    xlab = "Dose in miligrams per day",
    ylab = "Tooth length"
)
```

## B. Summary of ToothGrowth
```{r}
summary(ToothGrowth)
```

## C. Test of normality of Tooth length
The ¨*Shapiro-Wilk Normality Test* is used, The null hypothesis for this test is that the given data is normally distributed. Results indicate we can't reject this hypotesis, so **we assume the distribution is normal**.
```{r normality, echo = T}
shapiro.test(ToothGrowth$len)
```

A histogram with an overlaid density curve of this variable and a Normal Q-Q plot are generated to support the assumtion its distribution is normal.
```{r histogram qqplot, echo = T}
par(mfrow = c(1, 2))
hist(ToothGrowth$len, probability = T, ylim = c(0, 0.05), 
    main = "Histogram and Density\n of Tooth length",
    xlab = "Tooth length",
    col = "#FFFF66"
    )
lines(density(ToothGrowth$len))

qqnorm(y = ToothGrowth$len, 
    main = "Normal Q-Q Plot\n for Tooth length",
    pch = 21, bg = c("#FFFF66"))
qqline(y = ToothGrowth$len)
```

## D. Test if variance is equal across groups
The *Levene's test of homogenity of variance is used*. Groups are: *Supplement type*; *Dose in miligrams per day*; and *Supplement type* and *Dose in miligrams per day*. Results indicate groups **don't have equal variance**.

```{r levene by supp, echo = T}
library(car)
leveneTest(len ~ supp, data = ToothGrowth)
leveneTest(len ~ as.factor(dose), data = ToothGrowth)
leveneTest(len ~ supp * as.factor(dose), data = ToothGrowth)
```
